#!/usr/bin/env -S bash -euo pipefail
# -------------------------------------------------------------------------------------------------------------------- #
# HUGO: NEW CONTENT
# -------------------------------------------------------------------------------------------------------------------- #
# @package    Bash
# @author     Kai Kimera <mail@kaikim.ru>
# @license    MIT
# @version    0.1.0
# @link       https://kaikim.ru/
# -------------------------------------------------------------------------------------------------------------------- #

(( EUID == 0 )) && { echo >&2 'This script should not be run as root!'; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

# Parameters.
type="${1:-'articles'}"; readonly type

# -------------------------------------------------------------------------------------------------------------------- #
# -----------------------------------------------------< SCRIPT >----------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

function _year() {
  date -u '+%Y'
}

function _month() {
  date -u '+%m'
}

function _timestamp() {
  echo "$(( $( date -u '+%s%N' ) / 1000000 ))"
}

function _random() {
  shuf -i '1000-9999' -n 1 --random-source='/dev/random'
}

function hugo_post() {
  hugo new content "${type}/$( _year )/$( _month )/$( _timestamp )_$(_random)"
}

function main() {
  hugo_post
}; main "$@"
